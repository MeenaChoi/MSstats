<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title> • MSstatsdev</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="">
<meta property="og:description" content="MSstatsdev">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">MSstatsdev</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">3.23.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/MSstats.html">UNKNOWN TITLE</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="MSstats_files/accessible-code-block-0.0.1/empty-anchor.js"></script><link href="MSstats_files/anchor-sections-1.0/anchor-sections.css" rel="stylesheet">
<script src="MSstats_files/anchor-sections-1.0/anchor-sections.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip></h1>
            
      
      
      <div class="hidden name"><code>MSstats.Rmd</code></div>

    </div>

    
    
<script type="text/javascript">
document.addEventListener("DOMContentLoaded", function() {
  document.querySelector("h1").className = "title";
});
</script><script type="text/javascript">
document.addEventListener("DOMContentLoaded", function() {
  var links = document.links;  
  for (var i = 0, linksLength = links.length; i < linksLength; i++)
    if (links[i].hostname != window.location.hostname)
      links[i].target = '_blank';
});
</script><!--
%\VignetteIndexEntry{MSstats: Protein/Peptide significance analysis}
%\VignetteEngine{knitr::knitr}
--><div id="msstats-proteinpeptide-significance-analysis" class="section level1">
<h1 class="hasAnchor">
<a href="#msstats-proteinpeptide-significance-analysis" class="anchor"></a>MSstats: Protein/Peptide significance analysis</h1>
<p>Package: MSstats</p>
<p>Author: Meena Choi <a href="mailto:mnchoi67@gmail.com" class="email">mnchoi67@gmail.com</a>, Tsung-Heng Tsai <a href="mailto:tsai.tsungheng@gmail.com" class="email">tsai.tsungheng@gmail.com</a>, Cyril Galitzine <a href="mailto:cyrildgg@gmail.com" class="email">cyrildgg@gmail.com</a></p>
<p>Date: October 31, 2019</p>
<p>This vignette summarizes the introduction and various options of all functionalities in MSstats. More details are available in <code>User Manual</code>.</p>
<ul>
<li>The types of experiment that MSstats can analyze are LC-MS, SRM, DIA(SWATH) with label-free or labeled synthetic peptides. MSstats does not support for metabolic labeling or iTRAQ experiments.</li>
</ul>
<div id="skylinetomsstatsformat" class="section level2">
<h2 class="hasAnchor">
<a href="#skylinetomsstatsformat" class="anchor"></a>SkylinetoMSstatsFormat</h2>
<p>Preprocess MSstats input report from Skyline and convert into the required input format for MSstats.</p>
<div id="arguments" class="section level3">
<h3 class="hasAnchor">
<a href="#arguments" class="anchor"></a>Arguments</h3>
<ul>
<li>
<code>input</code> : name of MSstats input report from Skyline, which includes feature-level data.</li>
<li>
<code>annotation</code> : name of ‘annotation.txt’ data which includes <code>Condition</code>, <code>BioReplicate</code>, <code>Run</code>. If annotation is already complete in Skyline, use <code>annotation=NULL</code> (default). It will use the annotation information from input.</li>
<li>
<code>removeiRT</code> : <code>removeiRT=TRUE</code>(default) will remove the proteins or peptides which are labeld ‘iRT’ in ‘StandardType’ column. <code>removeiRT=FALSE</code> will keep them.</li>
<li>
<code>removeProtein_with1Peptide</code> : <code>removeProtein_with1Peptide=TRUE</code> will remove the proteins which have only 1 peptide and charge. <code>removeProtein_with1Peptide=FALSE</code> is default.</li>
<li>
<code>filter_with_Qvalue</code> : <code>removeProtein_with1Peptide=TRUE</code>(default) will filter out the intensities that have greater than <code>qvalue_cutoff</code> in <code>DetectionQValue</code> column. Those intensities will be replaced with zero and will be considered as censored missing values for imputation purpose.</li>
<li>
<code>qvalue_cutoff</code> : Cutoff for <code>DetectionQValue</code>. default is 0.01.</li>
</ul>
</div>
<div id="example" class="section level3">
<h3 class="hasAnchor">
<a href="#example" class="anchor"></a>Example</h3>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># 'MSstatsInput.csv' is the MSstats report from Skyline.</span>
<span class="va">input</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.csv</a></span><span class="op">(</span>file<span class="op">=</span><span class="st">"MSstatsInput.csv"</span><span class="op">)</span>

<span class="va">raw</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/SkylinetoMSstatsFormat.html">SkylinetoMSstatsFormat</a></span><span class="op">(</span><span class="va">input</span><span class="op">)</span></code></pre></div>
</div>
</div>
<div id="maxqtomsstatsformat" class="section level2">
<h2 class="hasAnchor">
<a href="#maxqtomsstatsformat" class="anchor"></a>MaxQtoMSstatsFormat</h2>
<p>Convert MaxQuant output into the required input format for MSstats.</p>
<div id="arguments-1" class="section level3">
<h3 class="hasAnchor">
<a href="#arguments-1" class="anchor"></a>Arguments</h3>
<ul>
<li>
<code>evidence</code> : name of <code>'evidence.txt'</code> data, which includes feature-level data.</li>
<li>
<code>annotation</code> : name of <code>'annotation.txt'</code> data which includes <code>Raw.file</code>, <code>Condition</code>, <code>BioReplicate</code>, <code>Run</code>, <code>IsotopeLabelType</code> information.</li>
<li>
<code>proteinGroups</code> : name of <code>'proteinGroups.txt'</code> data. It needs to matching protein group ID. If <code>proteinGroups=NULL</code>, use <code>'Proteins'</code> column in <code>'evidence.txt'</code>.</li>
<li>
<code>proteinID</code> : <code>'Proteins'</code>(default) or <code>'proteinGroups'</code> in <code>'proteinGroup.txt'</code> for Protein ID.</li>
<li>
<code>useUniquePeptide</code> : <code>useUniquePeptide=TRUE</code>(default) removes peptides that are assigned for more than one proteins. We assume to use unique peptide for each protein.</li>
<li>
<code>summaryforMultipleRows</code> : <code>summaryforMultipleRows=max</code>(default) or sum, when there are multiple measurements for certain feature and certain run, use highest or sum of all.</li>
<li>
<code>fewMeasurements</code> : <code>fewMeasurements='remove'</code>(default) will remove the features that have 1 or 2 measurements across runs.</li>
<li>
<code>removeMpeptides</code> : <code>removeMpeptides=TRUE</code>(default) will remove the peptides including ‘M’ sequence.</li>
<li>
<code>removeProtein_with1Peptide</code> : <code>removeProtein_with1Peptide=TRUE</code> will remove the proteins which have only 1 peptide and charge. <code>FALSE</code> is default.</li>
</ul>
</div>
<div id="example-1" class="section level3">
<h3 class="hasAnchor">
<a href="#example-1" class="anchor"></a>Example</h3>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Read in MaxQuant files</span>
<span class="va">proteinGroups</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.table</a></span><span class="op">(</span><span class="st">"proteinGroups.txt"</span>, sep<span class="op">=</span><span class="st">"\t"</span>, header<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>

<span class="va">infile</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.table</a></span><span class="op">(</span><span class="st">"evidence.txt"</span>, sep<span class="op">=</span><span class="st">"\t"</span>, header<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>

<span class="co"># Read in annotation including condition and biological replicates per run.</span>
<span class="co"># Users should make this annotation file. It is not the output from MaxQuant.</span>
<span class="va">annot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.csv</a></span><span class="op">(</span><span class="st">"annotation.csv"</span>, header<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>

<span class="va">raw</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/MaxQtoMSstatsFormat.html">MaxQtoMSstatsFormat</a></span><span class="op">(</span>evidence<span class="op">=</span><span class="va">infile</span>, 
                           annotation<span class="op">=</span><span class="va">annot</span>, 
                           proteinGroups<span class="op">=</span><span class="va">proteinGroups</span><span class="op">)</span></code></pre></div>
</div>
</div>
<div id="progenesistomsstatsformat" class="section level2">
<h2 class="hasAnchor">
<a href="#progenesistomsstatsformat" class="anchor"></a>ProgenesistoMSstatsFormat</h2>
<p>Convert Progenesis output into the required input format for MSstats.</p>
<div id="arguments-2" class="section level3">
<h3 class="hasAnchor">
<a href="#arguments-2" class="anchor"></a>Arguments</h3>
<ul>
<li>
<code>input</code> : name of Progenesis output, which is wide-format. <code>Accession</code>, <code>Sequence</code>, <code>Modification</code>, <code>Charge</code> and one column for each run are required.</li>
<li>
<code>annotation</code> : name of <code>'annotation.txt'</code> or <code>'annotation.csv'</code> data which includes <code>Condition</code>, <code>BioReplicate</code>, <code>Run</code> information. It will be matched with the column name of input for MS runs.</li>
<li>
<code>useUniquePeptide</code> : <code>useUniquePeptide=TRUE</code>(default) removes peptides that are assigned for more than one proteins. We assume to use unique peptide for each protein.</li>
<li>
<code>summaryforMultipleRows</code> : <code>summaryforMultipleRows=max</code>(default) or <code>sum</code>, when there are multiple measurements for certain feature and certain run, use highest or sum of multiple intensities.</li>
<li>
<code>fewMeasurements</code> : <code>fewMeasurements='remove'</code>(default) will remove the features that have 1 or 2 measurements across runs.</li>
<li>
<code>removeProtein_with1Peptide</code> : <code>removeProtein_with1Peptide=TRUE</code> will remove the proteins which have only 1 peptide and charge. <code>FALSE</code> is default.</li>
</ul>
</div>
<div id="example-2" class="section level3">
<h3 class="hasAnchor">
<a href="#example-2" class="anchor"></a>Example</h3>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">input</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.csv</a></span><span class="op">(</span><span class="st">"output_progenesis.csv"</span>, stringsAsFactors<span class="op">=</span><span class="cn">F</span><span class="op">)</span> 

<span class="co"># Read in annotation including condition and biological replicates per run.</span>
<span class="co"># Users should make this annotation file. It is not the output from Progenesis.</span>
<span class="va">annot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.csv</a></span><span class="op">(</span><span class="st">'annotation.csv'</span><span class="op">)</span>

<span class="va">raw</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ProgenesistoMSstatsFormat.html">ProgenesistoMSstatsFormat</a></span><span class="op">(</span><span class="va">input</span>, annotation<span class="op">=</span><span class="va">annot</span><span class="op">)</span></code></pre></div>
</div>
</div>
<div id="spectronauttomsstatsformat" class="section level2">
<h2 class="hasAnchor">
<a href="#spectronauttomsstatsformat" class="anchor"></a>SpectronauttoMSstatsFormat</h2>
<p>Convert Spectronaut output into the required input format for MSstats.</p>
<div id="arguments-3" class="section level3">
<h3 class="hasAnchor">
<a href="#arguments-3" class="anchor"></a>Arguments</h3>
<ul>
<li>
<code>input</code>: name of Spectronaut output, which is long-format. <code>ProteinName</code>, <code>PeptideSequence</code>, <code>PrecursorCharge</code>, <code>FragmentIon</code>, <code>ProductCharge</code>, <code>IsotopeLabelType</code>, <code>Condition</code>, <code>BioReplicate</code>, <code>Run</code>, <code>Intensity</code>, <code>F.ExcludedFromQuantification</code> are required. Rows with <code>F.ExcludedFromQuantification=True</code> will be removed.</li>
<li>
<code>summaryforMultipleRows</code> : <code>summaryforMultipleRows=max</code>(default) or <code>sum</code>, when there are multiple measurements for certain feature and certain run, use highest or sum of multiple intensities.</li>
</ul>
</div>
<div id="example-3" class="section level3">
<h3 class="hasAnchor">
<a href="#example-3" class="anchor"></a>Example</h3>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">input</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.csv</a></span><span class="op">(</span><span class="st">"output_spectronaut.csv"</span>, stringsAsFactors<span class="op">=</span><span class="cn">F</span><span class="op">)</span> 

<span class="va">quant</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/SpectronauttoMSstatsFormat.html">SpectronauttoMSstatsFormat</a></span><span class="op">(</span><span class="va">input</span><span class="op">)</span></code></pre></div>
</div>
</div>
<div id="dataprocess" class="section level2">
<h2 class="hasAnchor">
<a href="#dataprocess" class="anchor"></a>dataProcess</h2>
<p>Data pre-processing and quality control of MS runs of the original raw data into quantitative data for model fitting and group comparison. Log transformation is automatically applied and additional variables are created in columns for model fitting and group comparison process. Three options of data pre-processing and quality control of MS runs in dataProcess are</p>
<ul>
<li>Transformation: logarithm transformation of intensity with base 2 or 10.</li>
<li>Normalization: to remove systematic bias between MS runs.</li>
</ul>
<div id="arguments-4" class="section level3">
<h3 class="hasAnchor">
<a href="#arguments-4" class="anchor"></a>Arguments</h3>
<ul>
<li>
<code>raw</code> : name of the raw (input) data set.</li>
<li>
<code>logTrans</code> : logarithm transformation with base 2(default) or 10. If <code>logTrans=2</code>, the measurement of Variable <code>ABUNDANCE</code> is log-transformed with base 2. Same apply to <code>logTrans=10</code>.</li>
<li>
<code>normalization</code> : normalization to remove systematic bias between MS runs. There are three different normalizations supported. <code>'equalizeMedians'</code> (default) represents constant normalization (equalizing the medians) based on reference signals is performed. <code>'quantile'</code> represents quantile normalization based on reference signals is performed. <code>'globalStandards'</code> represents normalization with global standards proteins. <code>FALSE</code> represents no normalization is performed.</li>
<li>
<code>nameStandards</code> : vector of global standard peptide names. only for normalization with global standard peptides.</li>
<li>
<code>fillIncompleteRows</code> : If the input dataset has incomplete rows, <code>TRUE</code> (default) adds the rows with intensity value=NA for missing peaks. <code>FALSE</code> reports error message with list of features which have incomplete rows.</li>
<li>
<code>featureSubset</code> : <code>"all"</code> (default) uses all features that the data set has. <code>"top3"</code> uses top 3 features which have highest average of log2(intensity) across runs. <code>"topN"</code> uses top N features which has highest average of log2(intensity) across runs. It needs the input for <code>n_top_feature</code> option. <code>"highQuality"</code> flags uninformative feature and outliers.</li>
<li>
<code>remove_uninformative_feature_outlier</code> : It only works after users used <code>featureSubset="highQuality"</code> in dataProcess. <code>TRUE</code> allows to remove 1) the features are flagged in the column, <code>feature_quality="Uninformative"</code> which are features with bad quality, 2) outliers that are flagged in the column, <code>is_outlier=TRUE</code>, for run-level summarization. <code>FALSE</code> (default) uses all features and intensities for run-level summarization.</li>
<li>
<code>n_top_feature</code> : The number of top features for <code>featureSubset='topN'</code>. Default is <code>n_top_feature=3</code>, which means to use top 3 features.</li>
<li>
<code>summaryMethod</code> : <code>"TMP"</code> (default) means Tukey’s median polish, which is robust estimation method. <code>"linear"</code> uses linear mixed model.</li>
<li>
<code>equalFeatureVar</code> : only for <code>summaryMethod="linear"</code>. Default is <code>TRUE</code>. Logical variable for whether the model should account for heterogeneous variation among intensities from different features. Default is TRUE, which assume equal variance among intensities from features. <code>FALSE</code> means that we cannot assume equal variance among intensities from features, then we will account for heterogeneous variation from different features.</li>
<li>
<code>censoredInt</code> : Missing values are censored or at random. <code>'NA'</code> (default) assumes that all ‘NA’s in ’Intensity’ column are censored. <code>'0'</code> uses zero intensities as censored intensity. In this case, NA intensities are missing at random. The output from Skyline and Progenesis should use ‘0’. Null assumes that all NA intensites are randomly missing.</li>
<li>
<code>cutoffCensored</code> : Cutoff value for censoring. Only with <code>censoredInt='NA'</code> or <code>'0'</code>. Default is <code>'minFeature'</code>, which uses minimum value for each feature. <code>'minFeatureNRun'</code> uses the smallest between minimum value of corresponding feature and minimum value of corresponding run. <code>'minRun'</code> uses minumum value for each run.</li>
<li>
<code>MBimpute</code> : only for <code>summaryMethod="TMP"</code> and <code>censoredInt='NA'</code> or <code>'0'</code>. <code>TRUE</code> (default) imputes ‘NA’ or ‘0’ (depending on censoredInt option) by Accelated failure model. <code>FALSE</code> uses the values assigned by cutoffCensored.</li>
<li>
<code>remove50missing</code> : only for <code>summaryMethod="TMP"</code>. <code>TRUE</code> removes the runs which have more than 50% missing values. <code>FALSE</code> is default.</li>
<li>
<code>address</code> : the name of folder that will store the results. Default folder is the current working directory. The other assigned folder has to be existed under the current working directory. An output csv file is automatically created with the default name of “BetweenRunInterferenceFile.csv”. The command address can help to specify where to store the file as well as how to modify the beginning of the file name.</li>
<li>
<code>maxQuantileforCensored</code> : Maximum quantile for deciding censored missing values. Default is 0.999.</li>
</ul>
</div>
<div id="details-of-outputs" class="section level3">
<h3 class="hasAnchor">
<a href="#details-of-outputs" class="anchor"></a>Details of outputs</h3>
<div id="runleveldata-from-dataprocess" class="section level4">
<h4 class="hasAnchor">
<a href="#runleveldata-from-dataprocess" class="anchor"></a>RunlevelData from dataProcess</h4>
<ul>
<li>LogIntensities : Estimated protein abundance for aa<code>RUN</code> and <code>Protein</code>.</li>
<li>NumMeasuredFeature : Number of measured features in a <code>RUN</code> and <code>Protein</code>. It counts feature intensities greater than 1, after selecting all/topN/highquality features and removing features with only one measurement across MS runs.</li>
<li>Missing percentage : Number of measured features in a <code>RUN</code> and <code>Protein</code> /total number of features in a <code>Proteins</code>.</li>
<li>NumImputedFeature : Number of imputed intensities (censored intensities) in a <code>RUN</code> and <code>Protein</code>. This column is shown only if users allow to impute the missing value.</li>
</ul>
<div id="comparisonresult-from-groupcomparison-one-or-two-columns-will-be-added-" class="section level5">
<h5 class="hasAnchor">
<a href="#comparisonresult-from-groupcomparison-one-or-two-columns-will-be-added-" class="anchor"></a>ComparisonResult from groupComparison : one or two columns will be added.</h5>
<ul>
<li>MissingPercentage : Number of measured intensities/ total number of intensities (which is the number of features * the number of runs in a protein) by protein</li>
<li>ImputationPercentage : Number of imputed intensities/total number of intensities by protein</li>
</ul>
</div>
</div>
</div>
<div id="example-4" class="section level3">
<h3 class="hasAnchor">
<a href="#example-4" class="anchor"></a>Example</h3>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">QuantData</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/dataProcess.html">dataProcess</a></span><span class="op">(</span><span class="va">SRMRawData</span><span class="op">)</span></code></pre></div>
</div>
</div>
<div id="dataprocessplots" class="section level2">
<h2 class="hasAnchor">
<a href="#dataprocessplots" class="anchor"></a>dataProcessPlots</h2>
<p>Visualization for explanatory data analysis. To illustrate the quantitative data after data-preprocessing and quality control of MS runs, <code>dataProcessPlots</code> takes the quantitative data from function <code>dataProcess</code> as input and automatically generate three types of figures in pdf files as output :</p>
<ul>
<li><p>Profile plot : to identify the potential sources of variation for each protein. One of output from <code>dataProcess</code>, <code>xxx$ProcessedData</code>, is used for profile plots. Another output from <code>dataProcess</code>, <code>xxx$RunlevelData</code>, is used for profile plots with summarization. X-axis represents MS runs. Y-axis is for log-intensities of transitions. Reference/endogenous signals are in the left/right panel. Line colors indicate peptides and line types indicate transitions. Type of dots(filled vs empty dot) indicates censored missing values or not. In summarization plots, gray dots and lines are the same as original profile plots with <code>xxx$ProcessedData</code>. Dark dots and lines are for summarized intensities from <code>xxx$RunlevelData</code>.</p></li>
<li><p>Quality control plot : to illustrate the systematic bias between MS runs and to check normalization. After normalization, the reference signals for all proteins should be stable across MS runs. <code>xxx$ProcessedData</code> is used for plots. X-axis is for MS runs. Y-axis is for log-intensities of transition (<code>xxx$ProcessedData$ABUNDANCE</code>). Reference/endogenous signals are in the left/right panel. The pdf file contains (1) QC plot for all proteins and (2) QC plots for each protein separately.</p></li>
<li><p>Mean plot for conditions : to illustrate mean and variability of each condition per protein. Summarized intensnties from <code>xxx$RunlevelData</code> are used for plots. X-axis is for condition. Y-axis is for summarized log transformed intensities. If <code>scale=TRUE</code>, the levels of conditions is scaled according to its actual values at x-axis. Red points indicate the mean for each condition. If <code>interval="CI"</code>, error bars indicate the confidence interval with 0.95 significant level for each condition. If <code>interval="SD"</code>, error bars indicate the standard deviation for each condition. <strong>The interval is not related with model-based analysis in <code>groupCompaison</code></strong>.</p></li>
</ul>
<div id="arguments-5" class="section level3">
<h3 class="hasAnchor">
<a href="#arguments-5" class="anchor"></a>Arguments</h3>
<ul>
<li>
<code>data</code> : name of the (output of <code>dataProcess</code> function) data set.</li>
<li>
<code>type</code> : choice of visualization. <code>"ProfilePlot"</code> represents profile plot of log intensities across MS runs. <code>"QCPlot"</code> represents quality control plot of log intensities across MS runs. <code>"ConditionPlot"</code> represents mean plot of log ratios (Light/Heavy) across conditions.</li>
<li>
<code>featureName</code> : for <code>"ProfilePlot"</code> only, <code>"Transition"</code> (default) means printing feature legend in transition-level. <code>"Peptide"</code> means printing feature legend in peptide-level. <code>"NA"</code> means no feature legend printing.</li>
<li>
<code>ylimUp</code> : upper limit for y-axis in the log scale. <code>FALSE</code> (Default) for Profile Plot and QC Plot use the upper limit as rounded off maximum of log2(intensities) after normalization + 3. <code>FALSE</code> (Default) for Condition Plot is maximum of log ratio + SD or CI.</li>
<li>
<code>ylimDown</code> : lower limit for y-axis in the log scale. <code>FALSE</code> (Default) for Profile Plot and QC Plot is 0. `FALSE`` (Default) for Condition Plot is minumum of log ratio - SD or CI.</li>
<li>
<code>scale</code> : for <code>"ConditionPlot"</code> only, <code>FALSE</code> (default) means each conditional level is not scaled at x-axis according to its actual value (equal space at x-axis). <code>TRUE</code> means each conditional level is scaled at x-axis according to its actual value (unequal space at x-axis).</li>
<li>
<code>interval</code> : for <code>"ConditionPlot"</code> only, <code>"CI"</code> (default) uses confidence interval with 0.95 significant level for the width of error bar. <code>"SD"</code> uses standard deviation for the width of error bar.</li>
<li>
<code>x.axis.size</code> : size of x-axis labeling for “MS Runs” in Profile Plot and QC Plot, and “Condition” in Condition Plot. Default is <code>10</code>.</li>
<li>
<code>y.axis.size</code> : size of y-axis labels. Default is <code>10</code>.</li>
<li>
<code>text.size</code> : size of labels represented each condition at the top of graph in Profile Plot and QC plot. Default is <code>4</code>
</li>
<li>
<code>text.angle</code> : angle of labels represented each condition at the top of graph in Profile Plot and QC plot or x-axis labeling in Condition plot. Default is <code>0</code>.</li>
<li>
<code>legend.size</code> : size of feature legend (transition-level or peptide-level) above graph in Profile Plot. Default is <code>7</code>.</li>
<li>
<code>dot.size.profile</code> : size of dots in profile plot. Default is <code>2</code>.</li>
<li>
<code>dot.size.condition</code> : size of dots in condition plot. Default is <code>3</code>.</li>
<li>
<code>width</code> : width of the saved file. Default is 10.</li>
<li>
<code>height</code> : height of the saved file. Default is 10.</li>
<li>
<code>which.Protein</code> : Protein list to draw plots. List can be names of Proteins or order numbers of Proteins from <code><a href="https://rdrr.io/r/base/levels.html">levels(xxx$ProcessedData$PROTEIN)</a></code>. Default is <code>"all"</code>, which generates all plots for each protein.</li>
<li>
<code>originalPlot</code> : <code>TRUE</code> (default) draws original profile plots.</li>
<li>
<code>summaryPlot</code> : <code>TRUE</code> (default) draws profile plots with summarization for run levels.</li>
<li>
<code>save_condition_plot_result</code> : <code>TRUE</code> saves the table with values using condition plots. Default is FALSE.</li>
<li>
<code>address</code> : the name of folder that will store the results. Default folder is the current working directory. The other assigned folder has to be existed under the current working directory. An output pdf file is automatically created with the default name of <code>"ProfilePlot.pdf"</code> or <code>"QCplot.pdf"</code> or <code>"ConditionPlot.pdf"</code> or <code>"ConditionPlot_value.csv"</code>. The command address can help to specify where to store the file as well as how to modify the beginning of the file name. If <code>address=FALSE</code>, plot will be not saved as pdf file but showed in window.</li>
</ul>
</div>
<div id="example-5" class="section level3">
<h3 class="hasAnchor">
<a href="#example-5" class="anchor"></a>Example</h3>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># QuantData &lt;- dataProcess(SRMRawData)</span>
<span class="co"># </span>
<span class="co"># # Profile plot</span>
<span class="co"># dataProcessPlots(data=QuantData, type="ProfilePlot")</span>
<span class="co"># </span>
<span class="co"># # Quality control plot </span>
<span class="co"># dataProcessPlots(data=QuantData, type="QCPlot")   </span>
<span class="co"># </span>
<span class="co"># # Quantification plot for conditions</span>
<span class="co"># dataProcessPlots(data=QuantData, type="ConditionPlot")</span></code></pre></div>
</div>
</div>
<div id="groupcomparison" class="section level2">
<h2 class="hasAnchor">
<a href="#groupcomparison" class="anchor"></a>groupComparison</h2>
<p>Tests for significant changes in protein abundance across conditions based on a family of linear mixed-effects models in targeted Selected Reaction Monitoring (SRM), Data-Dependent Acquisition (DDA or shotgun), and Data-Independent Acquisition (DIA or SWATH-MS) experiment. It is applicable to multiple types of sample preparation, including label-free workflows, workflows that use stable isotope labeled reference proteins and peptides, and workflows that use fractionation. Experimental design of case-control study (patients are not repeatedly measured) or time course study (patients are repeatedly measured) is automatically determined based on proper statistical model.</p>
<div id="arguments-6" class="section level3">
<h3 class="hasAnchor">
<a href="#arguments-6" class="anchor"></a>Arguments</h3>
<ul>
<li>
<code>contrast.matrix</code> : comparison between conditions of interests. Based on the levels of conditions, specify 1 or -1 to the conditions of interests and 0 otherwise. The levels of conditions are sorted alphabetically. Command <code><a href="https://rdrr.io/r/base/levels.html">levels(xxx$ProcessedData$GROUP_ORIGINAL)</a></code> after using <code>dataProcess</code> function can illustrate the actual order of the levels of conditions.</li>
<li>
<code>data</code> : name of the (output of dataProcess function) data set.</li>
</ul>
</div>
<div id="example-6" class="section level3">
<h3 class="hasAnchor">
<a href="#example-6" class="anchor"></a>Example</h3>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># QuantData &lt;- dataProcess(SRMRawData)</span>
<span class="co"># </span>
<span class="co"># levels(QuantData$ProcessedData$GROUP_ORIGINAL)</span>
<span class="co"># comparison &lt;- matrix(c(-1,0,0,0,0,0,1,0,0,0), nrow=1)</span>
<span class="co"># row.names(comparison) &lt;- "T7-T1"</span>
<span class="co"># </span>
<span class="co"># # Tests for differentially abundant proteins with models:</span>
<span class="co"># testResultOneComparison &lt;- groupComparison(contrast.matrix=comparison, data=QuantData)</span></code></pre></div>
</div>
</div>
<div id="groupcomparisonplots" class="section level2">
<h2 class="hasAnchor">
<a href="#groupcomparisonplots" class="anchor"></a>groupComparisonPlots</h2>
<p>Visualization for model-based analysis and summarizing differentially abundant proteins. To summarize the results of log-fold changes and adjusted p-values for differentially abundant proteins, <code>groupComparisonPlots</code> takes testing results from function <code>groupComparison</code> as input and automatically generate three types of figures in pdf files as output :</p>
<ul>
<li><p>Volcano plot : For each comparison separately. It illustrates actual log-fold changes and adjusted p-values for each comparison separately with all proteins. The x-axis is the log fold change. The base of logarithm transformation is the same as specified in “logTrans” from <code>dataProcess</code>. The y-axis is the negative log2 or log10 adjusted p-values. The horizontal dashed line represents the FDR cutoff. The points below the FDR cutoff line are non-significantly abundant proteins (colored in black). The points above the FDR cutoff line are significantly abundant proteins (colored in red/blue for up-/down-regulated). If fold change cutoff is specified (<code>FCcutoff = specific value</code>), the points above the FDR cutoff line but within the FC cutoff line are non-significantly abundant proteins (colored in black).</p></li>
<li><p>Heatmap : For multiple comparisons. It illustratea up-/down-regulated proteins for multiple comparisons with all proteins. Each column represents each comparison of interest. Each row represents each protein. Color red/blue represents proteins in that specific comparison are significantly up-regulated/down-regulated proteins with FDR cutoff and/or FC cutoff. The color scheme shows the evidences of significance. The darker color it is, the stronger evidence of significance it has. Color gold represents proteins are not significantly different in abundance.</p></li>
<li><p>Comparison plot : For multiple comparisons per protein. It illustrates log-fold change and its variation of multiple comparisons for single protein. X-axis is comparison of interest. Y-axis is the log fold change. The red points are the estimated log fold change from the model. The error bars are the confidence interval with 0.95 significant level for log fold change. This interval is only based on the standard error, which is estimated from the model.</p></li>
</ul>
<div id="arguments-7" class="section level3">
<h3 class="hasAnchor">
<a href="#arguments-7" class="anchor"></a>Arguments</h3>
<ul>
<li>
<code>data</code> : <code>xxx$ComparisonResult</code> in testing output from function <code>groupComparison</code>.</li>
<li>
<code>type</code> : choice of visualization. <code>"VolcanoPlot"</code> represents volcano plot of log fold changes and adjusted p-values for each comparison separately. <code>"Heatmap"</code> represents heatmap of adjusted p-values for multiple comparisons. <code>"ComparisonPlot"</code> represents comparison plot of log fold changes for multiple comparisons per protein.</li>
<li>
<code>sig</code> : FDR cutoff for the adjusted p-values in heatmap and volcano plot. <span class="math inline">\(100(1-sig)\)</span>% confidence interval will be drawn. <code>sig=0.05</code> is default.</li>
<li>
<code>FCcutoff</code> : for volcano plot or heatmap, whether involve fold change cutoff or not. <code>FALSE</code> (default) means no fold change cutoff is applied for significance analysis. <code>FCcutoff = specific value</code> means specific fold change cutoff is applied.</li>
<li>
<code>logBase.pvalue</code> : for volcano plot or heatmap, (-) logarithm transformation of adjusted p-value with base 2 or 10(default).</li>
<li>
<code>ylimUp</code> : for all three plots, upper limit for y-axis. <code>FALSE</code> (default) for volcano plot/heatmap use maximum of -log2 (adjusted p-value) or -log10 (adjusted p-value). <code>FALSE</code> (default) for comparison plot uses maximum of log-fold change + CI.</li>
<li>
<code>ylimDown</code> : for all three plots, lower limit for y-axis. <code>FALSE</code> (default) for volcano plot/heatmap use minimum of -log2 (adjusted p-value) or -log10 (adjusted p-value). <code>FALSE</code> (default) for comparison plot uses minimum of log-fold change - CI.</li>
<li>
<code>xlimUp</code> : for Volcano plot, the limit for x-axis. <code>FALSE</code> (default) uses the maximum for absolute value of log-fold change or 3 as default if maximum for absolute value of log-fold change is less than 3.</li>
<li>
<code>x.axis.size</code> : size of axes labels, e.g. name of the comparisons in heatmap, and in comparison plot. Default is <code>10</code>.</li>
<li>
<code>y.axis.size</code> : size of axes labels, e.g. name of targeted proteins in heatmap. Default is <code>10</code>.</li>
<li>
<code>dot.size</code> : size of dots in volcano plot and comparison plot. Default is <code>3</code>.</li>
<li>
<code>text.size</code> : size of <code>ProteinName</code> label in the graph for Volcano Plot. Default is <code>4</code>.</li>
<li>
<code>legend.size</code> : size of legend for color at the bottom of volcano plot. Default is <code>7</code>.</li>
<li>
<code>ProteinName</code> : for volcano plot only, whether display protein names next to dots or not. <code>TRUE</code> (default) means protein names, which are significant, are displayed next to the points. <code>FALSE</code> means no protein names are displayed.</li>
<li>
<code>numProtein</code> : The number of proteins which will be presented in each heatmap. Default is <code>100</code>. Maximum possible number of protein for one heatmap is 180.</li>
<li>
<code>clustering</code> : Determines how to order proteins and comparisons. Hierarchical cluster analysis with Ward method(minimum variance) is performed. <code>'protein'</code> (default) means that protein dendrogram is computed and reordered based on protein means (the order of row is changed). <code>'comparison'</code> means comparison dendrogram is computed and reordered based on comparison means (the order of comparison is changed). <code>'both'</code> means to reorder both protein and comparison.</li>
<li>
<code>width</code> : width of the saved file. Default is <code>10</code>.</li>
<li>
<code>height</code> : height of the saved file. Default is <code>10</code>.</li>
<li>
<code>which.Comparison</code> : list of comparisons to draw plots. List can be labels of comparisons or order numbers of comparisons from <code><a href="https://rdrr.io/r/base/levels.html">levels(xxx$Label)</a></code>, such as <code><a href="https://rdrr.io/r/base/levels.html">levels(xxx$ComparisonResult$Label)</a></code>. Default is <code>"all"</code>, which generates all plots for each protein.</li>
<li>
<code>address</code> : the name of folder that will store the results. Default folder is the current working directory. The other assigned folder has to be existed under the current working directory. An output pdf file is automatically created with the default name of <code>"VolcanoPlot.pdf"</code> or <code>"Heatmap.pdf"</code> or <code>"ComparisonPlot.pdf"</code>. The command address can help to specify where to store the file as well as how to modify the beginning of the file name. If <code>address=FALSE</code>, plot will be not saved as pdf file but showed in window.</li>
</ul>
</div>
<div id="example-7" class="section level3">
<h3 class="hasAnchor">
<a href="#example-7" class="anchor"></a>Example</h3>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># QuantData &lt;- dataProcess(SRMRawData)</span>
<span class="co"># </span>
<span class="co"># # based on multiple comparisons  (T1 vs T3; T1 vs T7; T1 vs T9)</span>
<span class="co"># comparison1&lt;-matrix(c(-1,0,1,0,0,0,0,0,0,0),nrow=1)</span>
<span class="co"># comparison2&lt;-matrix(c(-1,0,0,0,0,0,1,0,0,0),nrow=1)</span>
<span class="co"># comparison3&lt;-matrix(c(-1,0,0,0,0,0,0,0,1,0),nrow=1)</span>
<span class="co"># comparison&lt;-rbind(comparison1,comparison2, comparison3)</span>
<span class="co"># row.names(comparison)&lt;-c("T3-T1","T7-T1","T9-T1")</span>
<span class="co"># </span>
<span class="co"># testResultMultiComparisons &lt;- groupComparison(contrast.matrix=comparison, data=QuantData)</span>
<span class="co"># </span>
<span class="co"># # Volcano plot </span>
<span class="co"># groupComparisonPlots(data=testResultMultiComparisons$ComparisonResult, type="VolcanoPlot")</span>
<span class="co"># </span>
<span class="co"># # Heatmap </span>
<span class="co"># groupComparisonPlots(data=testResultMultiComparisons$ComparisonResult, type="Heatmap")</span>
<span class="co"># </span>
<span class="co"># # Comparison Plot</span>
<span class="co"># groupComparisonPlots(data=testResultMultiComparisons$ComparisonResult, type="ComparisonPlot")</span></code></pre></div>
</div>
</div>
<div id="modelbasedqcplots" class="section level2">
<h2 class="hasAnchor">
<a href="#modelbasedqcplots" class="anchor"></a>modelBasedQCPlots</h2>
<p>Results based on statistical models for whole plot level inference are accurate as long as the assumptions of the model are met. The model assumes that the measurement errors are normally distributed with mean 0 and constant variance. The assumption of a constant variance can be checked by examining the residuals from the model.</p>
<p>To check the assumption of linear model for whole plot inference, <code>modelBasedQCPlots</code> takes the results after fitting models from function <code>groupComparison</code> as input and automatically generate two types of figures in pdf files as output.</p>
<ul>
<li><p>Normal quantile-quantile plot : For checking normally distributed errors. A normal quantile-quantile plot for each protein is generated in order to check whether the errors are well approximated by a normal distribution. If points fall approximately along a straight line, then the assumption is appropriate for that protein. Only large deviations from the line are problematic.</p></li>
<li><p>Residual plot : The plots of residuals against predicted (fitted) values. If it shows a random scatter, then the assumption is appropriate.</p></li>
</ul>
<div id="arguments-8" class="section level3">
<h3 class="hasAnchor">
<a href="#arguments-8" class="anchor"></a>Arguments</h3>
<ul>
<li>
<code>data</code> : output from function <code>groupComparison</code>.</li>
<li>
<code>type</code> : choice of visualization. <code>"QQPlots"</code> represents normal quantile-quantile plot for each protein after fitting models. <code>"ResidualPlots"</code> represents a plot of residuals versus fitted values for each protein in the dataset.</li>
<li>
<code>axis.size</code> : size of axes labels. Default is <code>10</code>.</li>
<li>
<code>dot.size</code> : size of points in the graph for residual plots and QQ plots. Default is <code>3</code>.</li>
<li>
<code>text.size</code> : size of labeling for feature names only in normal quantile-quantile plots separately for each feature. Default is <code>7</code>.</li>
<li>
<code>legend.size</code> : size of legend for feature names only in residual plots. Default is <code>7</code>.</li>
<li>
<code>width</code> : width of the saved file. Default is <code>10</code>.</li>
<li>
<code>height</code> : height of the saved file. Default is <code>10</code>.</li>
<li>
<code>address</code> : the name of folder that will store the results. Default folder is the current working directory. The other assigned folder has to be existed under the current working directory. If <code>type="residualPlots"</code> or <code>"QQPlots"</code>, <code>"ResidualPlots.pdf"</code> or <code>"QQPlots.plf"</code> will be generated. The command address can help to specify where to store the file as well as how to modify the beginning of the file name. If <code>address=FALSE</code>, plot will be not saved as pdf file but showed in window.</li>
</ul>
</div>
<div id="example-8" class="section level3">
<h3 class="hasAnchor">
<a href="#example-8" class="anchor"></a>Example</h3>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># testResultOneComparison &lt;- groupComparison(contrast.matrix=comparison, data=QuantData)</span>
<span class="co"># </span>
<span class="co"># # normal quantile-quantile plots</span>
<span class="co"># modelBasedQCPlots(data=testResultOneComparison, type="QQPlots")</span>
<span class="co"># </span>
<span class="co"># # residual plots</span>
<span class="co"># modelBasedQCPlots(data=testResultOneComparison, type="ResidualPlots")</span></code></pre></div>
</div>
</div>
<div id="designsamplesize" class="section level2">
<h2 class="hasAnchor">
<a href="#designsamplesize" class="anchor"></a>designSampleSize</h2>
<p>Calculate sample size for future experiments of a Selected Reaction Monitoring (SRM), Data-Dependent Acquisition (DDA or shotgun), and Data-Independent Acquisition (DIA or SWATH-MS) experiment based on intensity-based linear model. The function fits the model and uses variance components to calculate sample size. The underlying model fitting with intensity-based linear model with technical MS run replication. Estimated sample size is rounded to 0 decimal. Two options of the calculation:</p>
<ul>
<li>number of biological replicates per condition</li>
<li>power</li>
</ul>
<div id="arguments-9" class="section level3">
<h3 class="hasAnchor">
<a href="#arguments-9" class="anchor"></a>Arguments</h3>
<ul>
<li>
<code>data</code> : <code>'fittedmodel'</code> in testing output from function <code>groupComparison</code>.</li>
<li>
<code>desiredFC</code> : the range of a desired fold change which includes the lower and upper values of the desired fold change.</li>
<li>
<code>FDR</code> : a pre-specified false discovery ratio (FDR) to control the overall false positive. Default is <code>0.05</code>.</li>
<li>
<code>numSample</code> : minimal number of biological replicates per condition. <code>TRUE</code> represents you require to calculate the sample size for this category, else you should input the exact number of biological replicates.</li>
<li>
<code>power</code> : a pre-specified statistical power which defined as the probability of detecting a true fold change. <code>TRUE</code> represent you require to calculate the power for this category, else you should input the average of power you expect. Default is <code>0.9</code>.</li>
</ul>
</div>
<div id="example-9" class="section level3">
<h3 class="hasAnchor">
<a href="#example-9" class="anchor"></a>Example</h3>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># QuantData &lt;- dataProcess(SRMRawData)</span>
<span class="co"># head(QuantData$ProcessedData)</span>
<span class="co"># </span>
<span class="co"># ## based on multiple comparisons  (T1 vs T3; T1 vs T7; T1 vs T9)</span>
<span class="co"># comparison1 &lt;- matrix(c(-1,0,1,0,0,0,0,0,0,0),nrow=1)</span>
<span class="co"># comparison2 &lt;- matrix(c(-1,0,0,0,0,0,1,0,0,0),nrow=1)</span>
<span class="co"># comparison3 &lt;- matrix(c(-1,0,0,0,0,0,0,0,1,0),nrow=1)</span>
<span class="co"># comparison &lt;- rbind(comparison1,comparison2, comparison3)</span>
<span class="co"># row.names(comparison) &lt;- c("T3-T1","T7-T1","T9-T1")</span>
<span class="co"># </span>
<span class="co"># testResultMultiComparisons &lt;- groupComparison(contrast.matrix=comparison,data=QuantData)</span>
<span class="co"># </span>
<span class="co"># #(1) Minimal number of biological replicates per condition</span>
<span class="co"># designSampleSize(data=testResultMultiComparisons$fittedmodel, numSample=TRUE,</span>
<span class="co">#   desiredFC=c(1.25,1.75), FDR=0.05, power=0.8)</span>
<span class="co"># </span>
<span class="co"># #(2) Power calculation</span>
<span class="co"># designSampleSize(data=testResultMultiComparisons$fittedmodel, numSample=2,</span>
<span class="co">#   desiredFC=c(1.25,1.75), FDR=0.05, power=TRUE)</span></code></pre></div>
</div>
</div>
<div id="designsamplesizeplots" class="section level2">
<h2 class="hasAnchor">
<a href="#designsamplesizeplots" class="anchor"></a>designSampleSizePlots</h2>
<p>To illustrate the relationship of desired fold change and the calculated minimal number sample size which are</p>
<ul>
<li>Number of biological replicates per condition</li>
<li>power.</li>
</ul>
<p>The input is the result from function <code>designSampleSize</code>.</p>
<div id="arguments-10" class="section level3">
<h3 class="hasAnchor">
<a href="#arguments-10" class="anchor"></a>Arguments</h3>
<ul>
<li>
<code>data</code> : output from function <code>designSampleSize</code>.</li>
</ul>
</div>
<div id="example-10" class="section level3">
<h3 class="hasAnchor">
<a href="#example-10" class="anchor"></a>Example</h3>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># # (1) Minimal number of biological replicates per condition</span>
<span class="co"># result.sample &lt;- designSampleSize(data=testResultMultiComparisons$fittedmodel, numSample=TRUE,</span>
<span class="co">#                                 desiredFC=c(1.25,1.75), FDR=0.05, power=0.8)</span>
<span class="co"># designSampleSizePlots(data=result.sample)</span>
<span class="co"># </span>
<span class="co"># # (2) Power</span>
<span class="co"># result.power &lt;- designSampleSize(data=testResultMultiComparisons$fittedmodel, numSample=2,</span>
<span class="co">#                                desiredFC=c(1.25,1.75), FDR=0.05, power=TRUE)</span>
<span class="co"># designSampleSizePlots(data=result.power)</span></code></pre></div>
</div>
</div>
<div id="quantification" class="section level2">
<h2 class="hasAnchor">
<a href="#quantification" class="anchor"></a>quantification</h2>
<p>Model-based quantification for each condition or for each biological samples per protein in a targeted Selected Reaction Monitoring (SRM), Data-Dependent Acquisition (DDA or shotgun), and Data-Independent Acquisition (DIA or SWATH-MS) experiment. Quantification takes the processed data set by <code>dataProcess</code> as input and automatically generate the quantification results (data.frame) with long or matrix format. The quantification for endogenous samples is based on run summarization from subplot model, with TMP robust estimation.</p>
<ul>
<li><p>Sample quantification : individual biological sample quantification for each protein. The label of each biological sample is a combination of the corresponding group and the sample ID. If there are no technical replicates or experimental replicates per sample, sample quantification is the same as run summarization from dataProcess (<code>xxx$RunlevelData</code> from <code>dataProcess</code>). If there are technical replicates or experimental replicates, sample quantification is median among run quantification corresponding MS runs.</p></li>
<li><p>Group quantification : quantification for individual group or individual condition per protein. It is median among sample quantification.</p></li>
</ul>
<div id="arguments-11" class="section level3">
<h3 class="hasAnchor">
<a href="#arguments-11" class="anchor"></a>Arguments</h3>
<ul>
<li>
<code>data</code> : name of the (processed) data set from <code>dataPRocess</code>.</li>
<li>
<code>type</code> : choice of quantification. <code>"Sample"</code> or <code>"Group"</code> for protein sample quantification or group quantification.</li>
<li>
<code>format</code> : choice of returned format. <code>"long"</code> for long format which has the columns named <code>Protein</code>, <code>Condition</code>, <code>LogIntensities</code> (and <code>BioReplicate</code> if it is subject quantification), <code>NumFeature</code> for number of transitions for a protein, and <code>NumPeaks</code> for number of observed peak intensities for a protein. <code>"matrix"</code> for data matrix format which has the rows for Protein and the columns, which are <code>Groups</code>(or <code>Conditions</code>) for group quantification or the combinations of <code>BioReplicate</code> and <code>Condition</code> (labeled by <code>"BioReplicate"_"Condition"</code>) for sample quantification. Default is <code>"matrix"</code>, whether <code>format="long"</code> or <code>"matrix"</code>, both files, <code>"Group or SampleQuantification_longformat.csv"</code> and <code>"Group or SampleQuantification_dataMatrix.csv"</code> will be stored in the assigned folder.</li>
</ul>
</div>
<div id="example-11" class="section level3">
<h3 class="hasAnchor">
<a href="#example-11" class="anchor"></a>Example</h3>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># QuantData &lt;- dataProcess(SRMRawData)</span>
<span class="co"># </span>
<span class="co"># # Sample quantification</span>
<span class="co"># sampleQuant &lt;- quantification(QuantData)</span>
<span class="co"># </span>
<span class="co"># # Group quantification</span>
<span class="co"># groupQuant &lt;- quantification(QuantData, type="Group")</span></code></pre></div>
<hr>
</div>
</div>
</div>
<div id="assay-characterization" class="section level1">
<h1 class="hasAnchor">
<a href="#assay-characterization" class="anchor"></a>Assay characterization</h1>
<div id="nonlinear_quantlim" class="section level2">
<h2 class="hasAnchor">
<a href="#nonlinear_quantlim" class="anchor"></a>nonlinear_quantlim</h2>
<p>This function calculates the value of the LOB (limit of blank) and LOD (limit of detection) from the (<code>Concentration</code>, <code>Intensity</code>) spiked in data. This function should be used instead of the linear function whenever a significant threshold is present at low concentrations. Such threshold is characterized by a signal that is dominated by noise where the mean intensity is constant and independent of concentration. The function also returns the values of the nonlinear curve fit that allows it to be plotted. At least 2 blank samples (characterized by <code>Intensity = 0</code>) are required by this function which are used to calculate the background noise. The LOB is defined as the concentration at which the value of the nonlinear fit is equal to the 95% upper bound of the noise. The LOD is the concentration at which the latter is equal to the 90% lower bound (5% quantile) of the prediction interval of the nonlinear fit. A weighted nonlinear fit is used with weights for every unique concentration proportional to the inverse of variance between replicates. The details behind the calculation of the nonlinear fit can be found in the Reference.</p>
<p>The output is a data frame that contains the following columns:</p>
<ul>
<li>
<code>CONCENTRATION</code> : Concentration values at which the value of the fit is calculated.</li>
<li>
<code>MEAN</code> : The value of the curve fit.</li>
<li>
<code>LOW</code> : the lower bound of the 95% prediction interval.</li>
<li>
<code>UP</code> : the upper bound of the 95% prediction interval.</li>
<li>
<code>LOB</code> : LOB (one column with identical values)</li>
<li>
<code>LOD</code> : LOD (one column with identical values)</li>
<li>
<code>SLOPE</code> : the slope of the linear curve fit where only the spikes above LOD are considered.</li>
<li>
<code>INTERCEPT</code> : the intercept of the linear curve fit where only the spikes above LOD are considered .</li>
<li>
<code>NAME</code> : The name of the assay (identical to that provided in the input).</li>
<li>
<code>METHOD</code> : which is always set to <code>NONLINEAR</code> when this function is used. Each line of the data frame corresponds to a unique concentration value at which the value of the fit and prediction interval are evaluated. More unique concentrations values than in the input data frame are used to increase the accuracy of the LOB/D calculations.</li>
</ul>
<p>The LOB and LOD can only be calculated when more than 2 blank samples are included. The data should ideally be plotted using the companion function <code>plot_quantlim</code> to ensure that the fit is suited to the data.</p>
<div id="arguments-12" class="section level3">
<h3 class="hasAnchor">
<a href="#arguments-12" class="anchor"></a>Arguments</h3>
<ul>
<li>
<code>datain</code> : Data frame that contains the input data. The input data frame has to contain the following columns : <code>CONCENTRATION</code>, <code>INTENSITY</code> (both of which are measurements from the spiked in experiment) and <code>NAME</code> which designates the name of the assay (e.g. the name of the peptide or protein), Each line of the data frame contains one measurement from the spiked-in experiment. Multiple different <code>INTENSITY</code> values for the same <code>CONCENTRATION</code> are assumed to correspond to different replicates. Blank Samples are characterized by <code>CONCENTRATION = 0</code>.</li>
<li>
<code>alpha</code> : Probability level to estimate the LOB/LOD.</li>
<li>
<code>Npoints</code> : Number of points to use to discretize the concentration line between 0 and the maximum spiked concentration.</li>
<li>
<code>Nbootstrap</code> : Number of bootstrap samples to use to calculate the prediction interval of the fit. This number has to be increased for very low alpha values or whenever very accurate assay characterization is required.</li>
</ul>
</div>
<div id="example-12" class="section level3">
<h3 class="hasAnchor">
<a href="#example-12" class="anchor"></a>Example</h3>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># # Consider data from a spiked-in contained in an example dataset</span>
<span class="co"># head(SpikeInDataNonLinear)</span>
<span class="co"># </span>
<span class="co"># nonlinear_quantlim_out &lt;- nonlinear_quantlim(SpikeInDataNonLinear)</span>
<span class="co"># </span>
<span class="co"># # Get values of LOB/LOD</span>
<span class="co"># nonlinear_quantlim_out$LOB[1]</span>
<span class="co"># nonlinear_quantlim_out$LOD[1]</span></code></pre></div>
</div>
<div id="linear_quantlim" class="section level3">
<h3 class="hasAnchor">
<a href="#linear_quantlim" class="anchor"></a>linear_quantlim</h3>
<p>This function calculates the value of the LOB (limit of blank) and LOD (limit of detection) from the (<code>Concentration</code>, <code>Intensity</code>) spiked in data. The function also returns the values of the linear curve fit that allows it to be plotted. At least 2 blank samples (characterized by <code>Intensity = 0</code>) are required by this function which are used to calculate the background noise. The LOB is defined as the concentration at which the value of the linear fit is equal to the 95% upper bound of the noise. The LOD is the concentration at which the latter is equal to the 90% lower bound of the prediction interval (5% quantile) of the linear fit. A weighted linear fit is used with weights for every unique concentration proportional to the inverse of variance between replicates.</p>
<p>The output is a data frame that contains the following columns:</p>
<ul>
<li>
<code>CONCENTRATION</code> : Concentration values at which the value of the fit is calculated .</li>
<li>
<code>MEAN</code> : The value of the curve fit.</li>
<li>
<code>LOW</code> : the lower bound of the 95% prediction interval.</li>
<li>
<code>UP</code> : the upper bound of the 95% prediction interval.</li>
<li>
<code>LOB</code>: LOB (one column with identical values)</li>
<li>
<code>LOD</code> : LOD (one column with identical values)</li>
<li>
<code>SLOPE</code> : the slope of the linear curve fit where only the spikes above LOD are considered.</li>
<li>
<code>INTERCEPT</code> : the intercept of the linear curve fit where only the spikes above LOD are considered.</li>
<li>
<code>NAME</code> : The name of the assay (identical to that provided in the input).</li>
<li>
<code>METHOD</code> : which is always set to <code>LINEAR</code> when this function is used. Each line of the data frame corresponds to a unique concentration value at which the value of the fit and prediction interval are evaluated. More unique concentrations values than in the input data frame are used to increase the accuracy of the LOB/D calculations.</li>
</ul>
<p>The LOB and LOD can only be calculated when more than 2 blank samples are included. The data should ideally be plotted using the companion function <code>plot_quantlim</code> to ensure that a linear fit is suited to the data.</p>
</div>
<div id="arguments-13" class="section level3">
<h3 class="hasAnchor">
<a href="#arguments-13" class="anchor"></a>Arguments</h3>
<ul>
<li>
<code>datain</code> : Data frame that contains the input data. The input data frame has to contain the following columns : <code>CONCENTRATION</code>, <code>INTENSITY</code> (both of which are measurements from the spiked in experiment) and <code>NAME</code> which designates the name of the assay (e.g. the name of the peptide or protein) Each line of the data frame contains one measurement from the spiked-in experiment. Multiple different <code>INTENSITY</code> values for the same <code>CONCENTRATION</code> are assumed to correspond to different replicates. Blank Samples are characterized by <code>CONCENTRATION = 0</code>.</li>
<li>
<code>alpha</code> : Probability level to estimate the LOB/LOD.</li>
<li>
<code>Npoints</code> : Number of points to use to discretize the concentration line between 0 and the maximum spiked concentration.</li>
<li>
<code>{Nbootstrap</code> : Number of bootstrap samples to use to calculate the prediction interval of the fit. This number has to be increased for very low alpha values or whenever very accurate assay characterization is required.</li>
</ul>
</div>
<div id="example-13" class="section level3">
<h3 class="hasAnchor">
<a href="#example-13" class="anchor"></a>Example</h3>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># # Consider data from a spiked-in contained in an example dataset</span>
<span class="co"># head(SpikeInDataLinear)</span>
<span class="co"># </span>
<span class="co"># linear_quantlim_out &lt;- linear_quantlim(SpikeInDataLinear)</span>
<span class="co"># </span>
<span class="co"># # Get values of LOB/LOD</span>
<span class="co"># linear_quantlim_out$LOB[1]</span>
<span class="co"># linear_quantlim_out$LOD[1]</span></code></pre></div>
</div>
<div id="plot_quantlim" class="section level3">
<h3 class="hasAnchor">
<a href="#plot_quantlim" class="anchor"></a>plot_quantlim</h3>
<p>This function allows to plot the curve fit that is used to calculate the LOB and LOD with functions <code>nonlinear_quantlim</code> and <code>linear_quantlim</code>. The function outputs for each calibration curve, two pdf files each containg one plot. On the first, designated by <code>*_overall.pdf</code>, the entire concentration range is plotted. On the second plot, designated by <code>*_zoom.pdf</code>, the concentration range between 0 and <code>xlim_plot</code> (if specified in the argument of the function) is plotted. When no <code>xlim_plot</code> value is specified, the region close to LOB and LOD is automatically plotted.</p>
<p>This plotting function should ideally be used every time <code>nonlinear_quantlim</code> or <code>linear_quantlim</code> are called to visually ensure that the fits and data are accurate.</p>
</div>
<div id="arguments-14" class="section level3">
<h3 class="hasAnchor">
<a href="#arguments-14" class="anchor"></a>Arguments</h3>
<ul>
<li>
<code>spikeindata</code> : Data frame that contains the experimental spiked in data. This data frame should be identical to that used as input by function functions <code>nonlinear_quantlim</code> or <code>linear_quantlim</code>. The data frame has to contain the following columns : <code>CONCENTRATION</code>, <code>INTENSITY</code> (both of which are measurements from the spiked in experiment) and NAME which designates the name of the assay (e.g. the name of the peptide or protein).</li>
<li>
<code>quantlim_out</code> : Data frame that was output by functions <code>nonlinear_quantlim</code> or <code>linear_quantlim</code>.</li>
<li>
<code>alpha</code> : Probability level to estimate the LOB/LOD.</li>
<li>
<code>dir_output</code> : String containg the path of the directly where the pdf files of the plots should be output.</li>
<li>
<code>xlim_plot</code> : Optional argument containing the maximum xaxis value of the zoom plot. When no value is specified, a suitable value close to LOD is automatically chosen.</li>
</ul>
</div>
<div id="example-14" class="section level3">
<h3 class="hasAnchor">
<a href="#example-14" class="anchor"></a>Example</h3>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># # Consider data from a spiked-in contained in an example dataset</span>
<span class="co"># head(SpikeInDataNonLinear)</span>
<span class="co"># </span>
<span class="co"># nonlinear_quantlim_out &lt;- nonlinear_quantlim(SpikeInDataNonLinear, alpha = 0.05)</span>
<span class="co"># </span>
<span class="co"># #Get values of LOB/LOD</span>
<span class="co"># nonlinear_quantlim_out$LOB[1]</span>
<span class="co"># nonlinear_quantlim_out$LOD[1]</span>
<span class="co"># </span>
<span class="co"># plot_quantlim(spikeindata = SpikeInDataLinear, quantlim_out  = nonlinear_quantlim_out,</span>
<span class="co"># dir_output =  getwd(), alpha = 0.05)</span></code></pre></div>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Meena Choi, Mateusz Staniak, Tsung-Heng Tsai, Ting Huang, Olga Vitek.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
